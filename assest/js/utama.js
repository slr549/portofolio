// Multi-language Content
const translations = {
    id: {
        greeting: "Halo, saya",
        tagline: "Web Developer, UI/UX Designer, Graphic Designer & Data Analyst yang passionate menciptakan solusi digital yang impactful.",
        viewPortfolio: "Lihat Portfolio",
        downloadText: "Unduh CV",
        contactMe: "Hubungi Saya",
        projectsDone: "Proyek Selesai",
        happyClients: "Klien Puas",
        yearsExp: "Tahun Pengalaman",
        aboutTitle: "Tentang Saya",
        aboutSubtitle: "Menggabungkan kreativitas desain dengan teknologi untuk menciptakan solusi yang bermakna",
        aboutText1: "Saya adalah seorang profesional multidisiplin dengan spesialisasi dalam pengembangan web, desain UI/UX, desain grafis, dan analisis data. Dengan latar belakang yang unik ini, saya mampu melihat proyek dari berbagai perspektif dan menciptakan solusi yang tidak hanya indah secara visual tetapi juga fungsional dan data-driven.",
        aboutText2: "Passion saya adalah menciptakan pengalaman digital yang intuitive, accessible, dan impactful. Saya percaya bahwa teknologi yang baik adalah teknologi yang melayani manusia dengan baik, dan itulah filosofi yang saya terapkan dalam setiap proyek.",
        collaborate: "Mari Berkolaborasi",
        specialization: "Spesialisasi",
        skillsTitle: "Keterampilan",
        skillsSubtitle: "Kompetensi teknis dan kreatif yang luas untuk menangani proyek kompleks",
        frontendDev: "Frontend Development",
        uiuxDesign: "UI/UX Design",
        dataAnalysis: "Analisis Data",
        experienceTitle: "Pengalaman",
        experienceSubtitle: "Perjalanan profesional dan pencapaian karir",
        present: "Sekarang",
        role1: "Senior Full Stack Developer & Data Analyst",
        desc1: "Memimpin pengembangan aplikasi web modern dengan integrasi analitik data real-time. Membangun dashboard interaktif untuk visualisasi data dan implementasi machine learning models untuk prediksi bisnis.",
        role2: "UI/UX Designer & Frontend Developer",
        desc2: "Merancang dan mengembangkan antarmuka pengguna untuk berbagai klien startup dan enterprise. Meningkatkan engagement user sebesar 40% melalui desain yang data-driven dan user-centric.",
        role3: "Web Developer & Graphic Designer",
        desc3: "Mengembangkan website dan aplikasi mobile untuk berbagai klien. Membuat identitas visual dan material marketing yang konsisten untuk meningkatkan brand awareness.",
        projectsTitle: "Portfolio",
        projectsSubtitle: "Karya terbaik yang menunjukkan kemampuan multidisiplin",
        allProjects: "Semua Proyek",
        webProjects: "proyek website/aplikasi",
        uiuxProjects: "UI/UX Design",
        graphicProjects: "Desain Grafis",
        dataProjects: "Analisis Data",
        project1Title: "E-commerce Modern dengan React",
        project1Desc: "Platform e-commerce dengan fitur real-time analytics, rekomendasi produk AI, dan checkout yang seamless.",
        project2Title: "Dashboard Analitik Real-time",
        project2Desc: "Dashboard interaktif untuk visualisasi data dengan predictive analytics dan reporting otomatis.",
        project3Title: "Aplikasi Fintech Mobile",
        project3Desc: "Desain UI/UX untuk aplikasi mobile fintech dengan fokus pada user experience dan security.",
        liveDemo: "Live Demo",
        viewDashboard: "View Dashboard",
        caseStudy: "Case Study",
        contactTitle: "Hubungi Saya",
        contactSubtitle: "Mari berdiskusi tentang proyek, kolaborasi, atau peluang karir",
        getInTouch: "Hubungi Saya",
        followMe: "Follow Saya",
        sendMessage: "Kirim Pesan",
        footerTagline: "Menciptakan pengalaman digital yang bermakna melalui teknologi dan desain.",
        copyright: "© 2023 Raki Raihan. Hak cipta dilindungi."
    },
    en: {
        greeting: "Hello, I'm",
        tagline: "Web Developer, UI/UX Designer, Graphic Designer & Data Analyst passionate about creating impactful digital solutions.",
        viewPortfolio: "View Portfolio",
        downloadText: "Download CV",
        contactMe: "Contact Me",
        projectsDone: "Projects Done",
        happyClients: "Happy Clients",
        yearsExp: "Years Experience",
        aboutTitle: "About Me",
        aboutSubtitle: "Combining design creativity with technology to create meaningful solutions",
        aboutText1: "I am a multidisciplinary professional specializing in web development, UI/UX design, graphic design, and data analysis. With this unique background, I can view projects from multiple perspectives and create solutions that are not only visually appealing but also functional and data-driven.",
        aboutText2: "My passion is creating intuitive, accessible, and impactful digital experiences. I believe that good technology is technology that serves people well, and that's the philosophy I apply to every project.",
        collaborate: "Let's Collaborate",
        specialization: "Specialization",
        skillsTitle: "Skills",
        skillsSubtitle: "Broad technical and creative competencies to handle complex projects",
        frontendDev: "Frontend Development",
        uiuxDesign: "UI/UX Design",
        dataAnalysis: "Data Analysis",
        experienceTitle: "Experience",
        experienceSubtitle: "Professional journey and career achievements",
        present: "Present",
        role1: "Senior Full Stack Developer & Data Analyst",
        desc1: "Leading the development of modern web applications with real-time data analytics integration. Building interactive dashboards for data visualization and implementing machine learning models for business prediction.",
        role2: "UI/UX Designer & Frontend Developer",
        desc2: "Designing and developing user interfaces for various startup and enterprise clients. Increased user engagement by 40% through data-driven and user-centric design.",
        role3: "Web Developer & Graphic Designer",
        desc3: "Developing websites and mobile applications for various clients. Creating consistent visual identities and marketing materials to enhance brand awareness.",
        projectsTitle: "Portfolio",
        projectsSubtitle: "Best works showcasing multidisciplinary abilities",
        allProjects: "All Projects",
        webProjects: "website/application project",
        uiuxProjects: "UI/UX Design",
        graphicProjects: "Graphic Design",
        dataProjects: "Data Analysis",
        project1Title: "Modern E-commerce with React",
        project1Desc: "E-commerce platform with real-time analytics features, AI product recommendations, and seamless checkout.",
        project2Title: "Real-time Analytics Dashboard",
        project2Desc: "Interactive dashboard for data visualization with predictive analytics and automated reporting.",
        project3Title: "Fintech Mobile Application",
        project3Desc: "UI/UX design for fintech mobile application focusing on user experience and security.",
        liveDemo: "Live Demo",
        viewDashboard: "View Dashboard",
        caseStudy: "Case Study",
        contactTitle: "Contact Me",
        contactSubtitle: "Let's discuss projects, collaboration, or career opportunities",
        getInTouch: "Get in Touch",
        followMe: "Follow Me",
        sendMessage: "Send Message",
        footerTagline: "Creating meaningful digital experiences through technology and design.",
        copyright: "© 2023 Raki Raihan. All rights reserved."
    },
    ja: {
        greeting: "こんにちは、私は",
        tagline: "Web開発者、UI/UXデザイナー、グラフィックデザイナー、データアナリスト。影響力のあるデジタルソリューションの創造に情熱を持っています。",
        viewPortfolio: "ポートフォリオを見る",
        downloadText: "履歴書をダウンロード",
        contactMe: "お問い合わせ",
        projectsDone: "完了プロジェクト",
        happyClients: "満足したクライアント",
        yearsExp: "年の経験",
        aboutTitle: "私について",
        aboutSubtitle: "デザインの創造性と技術を組み合わせて意味のあるソリューションを創出",
        aboutText1: "私は、Web開発、UI/UXデザイン、グラフィックデザイン、データ分析を専門とする多分野のプロフェッショナルです。このユニークな背景により、複数の視点からプロジェクトを見ることができ、視覚的に美しいだけでなく、機能性がありデータ駆動型のソリューションを創出できます。",
        aboutText2: "私の情熱は、直感的でアクセスしやすく、影響力のあるデジタル体験を創造することです。優れたテクノロジーとは、人々をよくサービスするテクノロジーであると信じており、それがすべてのプロジェクトに適用する哲学です。",
        collaborate: "コラボレーションしましょう",
        specialization: "専門分野",
        skillsTitle: "スキル",
        skillsSubtitle: "複雑なプロジェクトに対応する幅広い技術的・創造的コンピテンシー",
        frontendDev: "フロントエンド開発",
        uiuxDesign: "UI/UXデザイン",
        dataAnalysis: "データ分析",
        experienceTitle: "経験",
        experienceSubtitle: "専門的なキャリアの歩みと成果",
        present: "現在",
        role1: "シニアフルスタック開発者＆データアナリスト",
        desc1: "リアルタイムデータ分析統合を備えた現代的なWebアプリケーションの開発を主導。データ可視化のためのインタラクティブなダッシュボードの構築とビジネス予測のための機械学習モデルの実装。",
        role2: "UI/UXデザイナー＆フロントエンド開発者",
        desc2: "様々なスタートアップおよび企業クライアント向けユーザーインターフェースの設計と開発。データ駆動型でユーザー中心のデザインによりユーザーエンゲージメントを40％向上。",
        role3: "Web開発者＆グラフィックデザイナー",
        desc3: "様々なクライアント向けWebサイトおよびモバイルアプリケーションの開発。ブランド認知度向上のための一貫した視覚的アイデンティティとマーケティング資料の作成。",
        projectsTitle: "ポートフォリオ",
        projectsSubtitle: "多分野の能力を示すベストワーク",
        allProjects: "すべてのプロジェクト",
        webProjects: "ウェブサイト/アプリケーションプロジェクト",
        uiuxProjects: "UI/UXデザイン",
        graphicProjects: "グラフィックデザイン",
        dataProjects: "データ分析",
        project1Title: "Reactを使用したモダンなEコマース",
        project1Desc: "リアルタイム分析機能、AI製品推奨、シームレスなチェックアウトを備えたEコマースプラットフォーム。",
        project2Title: "リアルタイム分析ダッシュボード",
        project2Desc: "予測分析と自動レポートを備えたデータ可視化のためのインタラクティブなダッシュボード。",
        project3Title: "フィンテックモバイルアプリケーション",
        project3Desc: "ユーザーエクスペリエンスとセキュリティに焦点を当てたフィンテックモバイルアプリケーションのUI/UXデザイン。",
        liveDemo: "ライブデモ",
        viewDashboard: "ダッシュボードを見る",
        caseStudy: "ケーススタディ",
        contactTitle: "お問い合わせ",
        contactSubtitle: "プロジェクト、コラボレーション、またはキャリアの機会について話し合いましょう",
        getInTouch: "お問い合わせ",
        followMe: "フォローする",
        sendMessage: "メッセージを送信",
        footerTagline: "技術とデザインを通じて意味のあるデジタル体験を創造します。",
        copyright: "© 2023 ラキ・ライハン。無断複写・転載を禁じます。"
    },
    zh: {
        greeting: "你好，我是",
        tagline: "网页开发人员、UI/UX设计师、平面设计师和数据分析师，热衷于创建有影响力的数字解决方案。",
        viewPortfolio: "查看作品集",
        downloadText: "下载简历",
        contactMe: "联系我",
        projectsDone: "完成项目",
        happyClients: "满意客户",
        yearsExp: "年经验",
        aboutTitle: "关于我",
        aboutSubtitle: "结合设计创意与技术，创造有意义的解决方案",
        aboutText1: "我是一位多学科专业人士，专注于网页开发、UI/UX设计、平面设计和数据分析。凭借这一独特背景，我能够从多个角度审视项目，并创建不仅视觉吸引人，而且功能性和数据驱动的解决方案。",
        aboutText2: "我的热情在于创造直观、可访问和有影响力的数字体验。我相信好的技术是能够很好地服务于人们的技术，这就是我应用于每个项目的理念。",
        collaborate: "让我们合作",
        specialization: "专业领域",
        skillsTitle: "技能",
        skillsSubtitle: "广泛的技术和创意能力，以处理复杂项目",
        frontendDev: "前端开发",
        uiuxDesign: "UI/UX设计",
        dataAnalysis: "数据分析",
        experienceTitle: "经验",
        experienceSubtitle: "专业历程和职业成就",
        present: "至今",
        role1: "高级全栈开发人员与数据分析师",
        desc1: "领导具有实时数据分析集成的现代网页应用程序开发。构建用于数据可视化的交互式仪表板，并实施用于业务预测的机器学习模型。",
        role2: "UI/UX设计师与前端开发人员",
        desc2: "为各种初创企业和企业客户设计和开发用户界面。通过数据驱动和以用户为中心的设计，将用户参与度提高了40%。",
        role3: "网页开发人员与平面设计师",
        desc3: "为各种客户开发网站和移动应用程序。创建一致的视觉标识和营销材料，以增强品牌知名度。",
        projectsTitle: "作品集",
        projectsSubtitle: "展示多学科能力的最佳作品",
        allProjects: "所有项目",
        webProjects: "网站/应用程序项目",
        uiuxProjects: "UI/UX设计",
        graphicProjects: "平面设计",
        dataProjects: "数据分析",
        project1Title: "使用React的现代电子商务",
        project1Desc: "具有实时分析功能、AI产品推荐和无缝结账的电子商务平台。",
        project2Title: "实时分析仪表板",
        project2Desc: "具有预测分析和自动报告的交互式数据可视化仪表板。",
        project3Title: "金融科技移动应用程序",
        project3Desc: "专注于用户体验和安全性的金融科技移动应用程序UI/UX设计。",
        liveDemo: "现场演示",
        viewDashboard: "查看仪表板",
        caseStudy: "案例研究",
        contactTitle: "联系我",
        contactSubtitle: "让我们讨论项目、合作或职业机会",
        getInTouch: "取得联系",
        followMe: "关注我",
        sendMessage: "发送消息",
        footerTagline: "通过技术和设计创造有意义的数字体验。",
        copyright: "© 2023 拉基·拉伊汉。保留所有权利。"
    }
};

// Current language and theme
let currentLang = 'id';
let currentTheme = 'light';

// Settings Dropdown Toggle
// Desktop && Mobile
const settingsBtn = document.getElementById('settingsBtn');
const settingsDropdown = document.getElementById('settingsDropdown');
const settingsBtnMobile = document.getElementById('settingsBtnMobile');
const settingsDropdownMobile = document.getElementById('settingsDropdownMobile');

if (settingsBtn && settingsDropdown) {
    settingsBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        settingsDropdown.classList.toggle('active');
    });
}

document.addEventListener('click', function(e) {
    if (
        settingsDropdown && settingsBtn &&
        settingsDropdownMobile && settingsBtnMobile &&
        !settingsDropdown.contains(e.target) &&
        !settingsBtn.contains(e.target) &&
        !settingsDropdownMobile.contains(e.target) &&
        !settingsBtnMobile.contains(e.target)
    ) {
        settingsDropdown.classList.remove('active');
        settingsDropdownMobile.classList.remove('active');
    }
}); 

// dropdown toggle for mobile
    if (settingsBtnMobile && settingsDropdownMobile) {
    settingsBtnMobile.addEventListener('click', function(e) {
        e.stopPropagation();
        settingsDropdownMobile.classList.toggle('active');
    });
}

// Language Switcher
document.querySelectorAll('.lang-option').forEach(option => {
    option.addEventListener('click', function() {
        // Update active option
        document.querySelectorAll('.lang-option').forEach(opt => opt.classList.remove('active'));
        this.classList.add('active');
        
        // Update language
        currentLang = this.getAttribute('data-lang');
        updateContent();
    });
});

// Theme Switcher
document.querySelectorAll('.theme-option').forEach(option => {
    option.addEventListener('click', function() {
        // Remove all theme classes
        document.body.classList.remove('light-theme', 'dark-theme', 'cyber-theme', 'nature-theme', 'sunset-theme');
        
        // Add selected theme
        const theme = this.getAttribute('data-theme');
        document.body.classList.add(theme + '-theme');
        currentTheme = theme;
        
        // Update active option in both groups
        document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
        this.classList.add('active');
        
        // If a theme is selected from custom colors, ensure dark/light mode options are not active
        if (theme === 'cyber' || theme === 'nature' || theme === 'sunset') {
            document.querySelectorAll('.theme-option[data-theme="light"], .theme-option[data-theme="dark"]').forEach(opt => {
                opt.classList.remove('active');
            });
        }
    });
});

// Update content based on language
function updateContent() {
    const langData = translations[currentLang];
    
    // Update all elements with data
    document.getElementById('greeting').textContent = langData.greeting;
    document.getElementById('tagline').textContent = langData.tagline;
    document.getElementById('viewPortfolio').textContent = langData.viewPortfolio;
    document.getElementById('downloadText').textContent = langData.downloadText;
    document.getElementById('contactMe').textContent = langData.contactMe;
    document.getElementById('projectsDone').textContent = langData.projectsDone;
    document.getElementById('happyClients').textContent = langData.happyClients;
    document.getElementById('yearsExp').textContent = langData.yearsExp;
    document.getElementById('aboutTitle').textContent = langData.aboutTitle;
    document.getElementById('aboutSubtitle').textContent = langData.aboutSubtitle;
    document.getElementById('aboutText1').textContent = langData.aboutText1;
    document.getElementById('aboutText2').textContent = langData.aboutText2;
    document.getElementById('collaborate').textContent = langData.collaborate;
    document.getElementById('specialization').textContent = langData.specialization;
    document.getElementById('skillsTitle').textContent = langData.skillsTitle;
    document.getElementById('skillsSubtitle').textContent = langData.skillsSubtitle;
    
    // Update skill category titles
    document.querySelectorAll('.skill-cat-title').forEach((el, index) => {
        if (index === 0) el.textContent = langData.frontendDev;
        else if (index === 1) el.textContent = langData.uiuxDesign;
        else if (index === 2) el.textContent = langData.dataAnalysis;
    });
    
    document.getElementById('experienceTitle').textContent = langData.experienceTitle;
    document.getElementById('experienceSubtitle').textContent = langData.experienceSubtitle;
    document.getElementById('present').textContent = langData.present;
    document.getElementById('role1').textContent = langData.role1;
    document.getElementById('desc1').textContent = langData.desc1;
    document.getElementById('role2').textContent = langData.role2;
    document.getElementById('desc2').textContent = langData.desc2;
    document.getElementById('role3').textContent = langData.role3;
    document.getElementById('desc3').textContent = langData.desc3;
    document.getElementById('projectsTitle').textContent = langData.projectsTitle;
    document.getElementById('projectsSubtitle').textContent = langData.projectsSubtitle;
    document.getElementById('allProjects').textContent = langData.allProjects;
    document.getElementById('webProjects').textContent = langData.webProjects;
    document.getElementById('uiuxProjects').textContent = langData.uiuxProjects;
    document.getElementById('graphicProjects').textContent = langData.graphicProjects;
    document.getElementById('dataProjects').textContent = langData.dataProjects;
    document.getElementById('project1Title').textContent = langData.project1Title;
    document.getElementById('project1Desc').textContent = langData.project1Desc;
    document.getElementById('project2Title').textContent = langData.project2Title;
    document.getElementById('project2Desc').textContent = langData.project2Desc;
    document.getElementById('project3Title').textContent = langData.project3Title;
    document.getElementById('project3Desc').textContent = langData.project3Desc;
    document.getElementById('liveDemo').textContent = langData.liveDemo;
    document.getElementById('viewDashboard').textContent = langData.viewDashboard;
    document.getElementById('caseStudy').textContent = langData.caseStudy;
    document.getElementById('contactTitle').textContent = langData.contactTitle;
    document.getElementById('contactSubtitle').textContent = langData.contactSubtitle;
    document.getElementById('getInTouch').textContent = langData.getInTouch;
    document.getElementById('followMe').textContent = langData.followMe;
    document.getElementById('sendMessage').textContent = langData.sendMessage;
    document.getElementById('footerTagline').textContent = langData.footerTagline;
    document.getElementById('copyright').textContent = langData.copyright;
}

// --- 1. SETTINGS & TRANSLATIONS (Tetap Sama) ---
// (Kode translations, language, theme switcher Anda sudah benar, 
// saya persingkat di sini agar fokus ke perbaikan logika)

// ... [Biarkan bagian translations dan theme settings seperti semula] ...

// --- TEMPEL BAGIAN INI MULAI DARI BAWAH THEME SWITCHER ---

// Mobile Menu Toggle
const mobileMenuBtn = document.getElementById('mobileMenuBtn');
const mobileNav = document.getElementById('mobileNav');

if (mobileMenuBtn) {
    mobileMenuBtn.addEventListener('click', () => {
        mobileNav.classList.toggle('active');
        mobileMenuBtn.innerHTML = mobileNav.classList.contains('active') 
            ? '<i class="fas fa-times"></i>' 
            : '<i class="fas fa-bars"></i>';
    });
}

// Skills Dropdown (Logika Accordion)
const skillHeaders = document.querySelectorAll('.category-header');

skillHeaders.forEach(header => {
    header.addEventListener('click', function() {
        const content = this.nextElementSibling;
        const icon = this.querySelector('.fa-chevron-down');
        
        if (content) {
            content.classList.toggle('active');
            
            // Putar icon
            if (icon) {
                icon.style.transform = content.classList.contains('active') 
                    ? 'rotate(180deg)' 
                    : 'rotate(0deg)';
            }
        }
    });
});

// Animate Skill Bars (Logika Loading Bar)
function animateSkillBars() {
    const skillBars = document.querySelectorAll('.skill-progress');
    
    // Setup Observer
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const bar = entry.target;
                const width = bar.getAttribute('data-width');
                
                // Delay sedikit agar transisi CSS terlihat
                setTimeout(() => {
                    bar.style.width = width + '%';
                }, 100);
                
                observer.unobserve(bar);
            }
        });
    }, { threshold: 0.1 });

    skillBars.forEach(bar => {
        bar.style.width = '0%'; // Reset ke 0 dulu
        observer.observe(bar);  // Observe langsung ke bar-nya
    });
}

// Experience Filtering
const filterButtons2 = document.querySelectorAll('.filter-btn2');
const timelineItems = document.querySelectorAll('.timeline-item');

filterButtons2.forEach(button => {
    button.addEventListener('click', () => {
        filterButtons2.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        
        const filterValue = button.getAttribute('data-filter');
        
        timelineItems.forEach(item => {
            if (filterValue === 'all' || item.getAttribute('data-category') === filterValue) {
                item.style.display = 'block';
                setTimeout(() => {
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, 10);
            } else {
                item.style.opacity = '0';
                item.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    item.style.display = 'none';
                }, 300);
            }
        });
    });
});

// Project Filtering
const filterButtons = document.querySelectorAll('.filter-btn');
const projectCards = document.querySelectorAll('.project-card');

filterButtons.forEach(button => {
    button.addEventListener('click', () => {
        filterButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        const filterValue = button.getAttribute('data-filter');
        
        projectCards.forEach(card => {
            if (filterValue === 'all' || card.getAttribute('data-category') === filterValue) {
                card.style.display = 'block';
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 10);
            } else {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.display = 'none';
                }, 300);
            }
        });
    });
});

// Form Submission
const contactForm = document.getElementById('contactForm');
if (contactForm) {
    contactForm.addEventListener('submit', (e) => {
        e.preventDefault();
        // Simulasi kirim
        alert('Pesan berhasil dikirim!');
        contactForm.reset();
    });
}

// Download CV
const downloadCVBtn = document.getElementById('downloadCV');
if (downloadCVBtn) {
    downloadCVBtn.addEventListener('click', (e) => {
        e.preventDefault();
        alert('Mengunduh CV...');
    });
}

// Scroll Animations
const fadeElements = document.querySelectorAll('.about, .skills, .experience, .projects, .contact');
const fadeInOnScroll = () => {
    fadeElements.forEach(element => {
        const elementTop = element.getBoundingClientRect().top;
        const elementVisible = 150;
        if (elementTop < window.innerHeight - elementVisible) {
            element.style.opacity = '1';
            element.style.transform = 'translateY(0)';
        }
    });
};
window.addEventListener('scroll', fadeInOnScroll);

// Navbar Scroll Effect
window.addEventListener('scroll', () => {
    const header = document.querySelector('header');
    if (window.scrollY > 100) {
        header.style.background = 'rgba(255, 255, 255, 0.95)';
        header.style.backdropFilter = 'blur(20px)';
    } else {
        header.style.background = 'var(--glass-bg)';
    }
});

// --- FUNGSI 3D BACKGROUND (Dipisah agar rapi) ---
function initThreeJS() {
    if (typeof THREE === 'undefined') return;
    const container = document.getElementById('three-bg');
    if (!container) return;

    // Bersihkan canvas lama
    while (container.firstChild) {
        container.removeChild(container.firstChild);
    }

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.z = 5;

    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    container.appendChild(renderer.domElement);

    // Partikel
    const particlesGeometry = new THREE.BufferGeometry();
    const particlesCount = 700;
    const posArray = new Float32Array(particlesCount * 3);

    for(let i = 0; i < particlesCount * 3; i++) {
        posArray[i] = (Math.random() - 0.5) * 15;
    }

    particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
    
    const material = new THREE.PointsMaterial({
        size: 0.025,
        color: 0x6366f1, // Warna default
        transparent: true,
        opacity: 0.8,
    });

    const particlesMesh = new THREE.Points(particlesGeometry, material);
    scene.add(particlesMesh);

    function animate() {
        requestAnimationFrame(animate);
        particlesMesh.rotation.y += 0.0005;
        renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
}

// --- INISIALISASI UTAMA (Saat Halaman Siap) ---
window.addEventListener('DOMContentLoaded', () => {
    // 1. Jalankan ThreeJS
    initThreeJS();

    // 2. Jalankan Animasi Skill Bar
    animateSkillBars();

    // 3. Jalankan Animasi Scroll
    fadeInOnScroll();

    // 4. Buka Otomatis Semua Skill (Sesuai keinginan Anda sebelumnya)
    const skillContents = document.querySelectorAll('.category-content');
    skillContents.forEach(content => {
        content.classList.add('active');
        const icon = content.parentElement.querySelector('.fa-chevron-down');
        if (icon) icon.style.transform = 'rotate(180deg)';
    });
});